---
title: "ãƒ«ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®å‡é›†åº¦ã‚’ä¸Šã’ã‚‹ React Router v7 ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°"
emoji: "ğŸ”§"
type: "tech"
topics: ["react", "reactrouter", "è¨­è¨ˆ", "å‡é›†åº¦", "ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°"]
published: true
---

## ã“ã‚Œã¯ãªã«ï¼Ÿ

[å‰å›ã®è¨˜äº‹](https://zenn.dev/coji/articles/react-router-v7-functional-cohesion-colocation)ã§ã¯ã€è³¼å…¥è€…ãƒ»å‡ºå“è€…ãƒ»ç®¡ç†è€…ã®ã‚ˆã†ã«ç•°ãªã‚‹ãƒ­ãƒ¼ãƒ«ã®æ©Ÿèƒ½ã‚’ã€ŒåŒã˜ã‚«ãƒ†ã‚´ãƒªã ã‹ã‚‰ã€ã¨ã¾ã¨ã‚ã¦ã—ã¾ã†å•é¡Œã‚’æ‰±ã„ã¾ã—ãŸã€‚ã‚³ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³æ§‹æˆã§ãƒ«ãƒ¼ãƒˆã‚’æ©Ÿèƒ½å˜ä½ã«åˆ†ã‘ã‚‹ã“ã¨ã§ã€æ¡ä»¶åˆ†å²ãŒæ•£ã‚‰ã°ã‚‰ãšä¿å®ˆã—ã‚„ã™ããªã‚‹ã¨ã„ã†è©±ã§ã—ãŸã€‚

ä»Šå›ã¯ã€ãã®ã€Œåˆ†ã‘ãŸãƒ«ãƒ¼ãƒˆã®ä¸­èº«ã€ã«æ³¨ç›®ã—ã¾ã™ã€‚ãƒ«ãƒ¼ãƒˆã‚’é©åˆ‡ã«åˆ†å‰²ã—ã¦ã‚‚ã€ã²ã¨ã¤ã®ãƒ«ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­ã§é–¢ä¿‚ãªã„å‡¦ç†ãŒæ··åœ¨ã—ã¦ã„ã‚‹ã¨ã€çµå±€ã‚³ãƒ¼ãƒ‰ã®è¦‹é€šã—ãŒæ‚ªããªã£ã¦ã—ã¾ã„ã¾ã™ã€‚

ã“ã®è¨˜äº‹ã§ã¯ã€ã‚ã‚ŠãŒã¡ãªãƒ«ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ®µéšçš„ã«ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã—ãªãŒã‚‰ã€å‡é›†åº¦ã‚’ä¸Šã’ã‚‹ã¨ã¯ã©ã†ã„ã†ã“ã¨ã‹ã‚’ä½“æ„Ÿã—ã¦ã‚‚ã‚‰ã„ã¾ã™ã€‚

æœ¬è¨˜äº‹ã®å†…å®¹ã‚’ Notebook LM ã§ã‚¹ãƒ©ã‚¤ãƒ‰åŒ–ã—ãŸã‚‚ã®ã‚‚å…¬é–‹ã—ã¦ã„ã¾ã™ã€‚è¦–è¦šçš„ã«æ¦‚è¦ã‚’æŠŠæ¡ã—ãŸã„æ–¹ã¯ã“ã¡ã‚‰ã‚‚ã©ã†ãã€‚

https://www.docswell.com/s/8723156/Z9MPDJ-2025-11-28-131456

æœ¬è¨˜äº‹ã®ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã‚’ Claude Code ãªã©ã® AI ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆå‘ã‘ã« CLAUDE.md ã¸è¨˜è¼‰ã™ã‚‹ä¾‹ã‚’ä»˜éŒ²ã«ç”¨æ„ã—ã¦ã„ã¾ã™ã€‚

## å‡é›†åº¦ã®æ­´å²ã¨æœ¬è³ª

å‡é›†åº¦ã¨ã„ã†è€ƒãˆæ–¹ã¯ã€1970å¹´ä»£ã®å¤§å‹ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿æ™‚ä»£ã«ç”Ÿã¾ã‚Œã¾ã—ãŸã€‚IBMã®æŠ€è¡“è€…ã ã£ãŸConstantineã€Myersã€StevensãŒã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®å¤‰æ›´ã«å¼·ã„æ§‹é€ ã‚’æ±‚ã‚ã¦æ•´ç†ã—ãŸã‚‚ã®ãŒå§‹ã¾ã‚Šã§ã™ã€‚å½“æ™‚ã®FORTRANã‚„PL/Iã§ã¯ã€å…±æœ‰ãƒ‡ãƒ¼ã‚¿ã‚„åˆ†å²ã«ä¾å­˜ã—ãŸå¤§è¦æ¨¡ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒä¸€èˆ¬çš„ã§ã€ä¸€åº¦ã‚³ãƒ¼ãƒ‰ãŒå´©ã‚Œã‚‹ã¨ä¿®æ­£ãŒé€£é–çš„ã«åºƒãŒã‚Šã€æ‰‹æˆ»ã‚ŠãŒãã‚ã‚ã¦å¤§ãããªã£ã¦ã„ã¾ã—ãŸã€‚ãã“ã§å½¼ã‚‰ã¯ã€å¤šæ•°ã®å®Ÿå‹™çš„ãªè¦³å¯Ÿã‚’ã‚‚ã¨ã«ã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å†…éƒ¨ã®å‡¦ç†ã©ã†ã—ãŒã©ã‚Œã ã‘ä¸€è²«ã—ãŸç›®çš„ã‚’å…±æœ‰ã—ã¦ã„ã‚‹ã‹ã¨ã„ã†è»¸ã§æ®µéšçš„ãªåˆ†é¡ã‚’ä½œã‚Šã€å¼·ã„ã¾ã¨ã¾ã‚Šã‚’æŒã¤æ§‹é€ ãŒã‚¨ãƒ©ãƒ¼ã‚„å¤‰æ›´ã«è€ãˆã‚‹ã¨ã„ã†æŒ‡é‡ã‚’æç¤ºã—ã¾ã—ãŸã€‚

ãã®å¾Œã€å‡é›†åº¦ã¯æ•°å€¤åŒ–ã‚„ç†è«–åŒ–ã‚’è©¦ã¿ã‚‹ç ”ç©¶ã«åºƒãŒã‚Šã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ãŒä¸€èˆ¬åŒ–ã—ãŸ1990å¹´ä»£ã«ã¯ã€ã‚¯ãƒ©ã‚¹è¨­è¨ˆã‚’è¨ºæ–­ã™ã‚‹ãŸã‚ã®æŒ‡æ¨™ã¨ã—ã¦å†è§£é‡ˆã•ã‚Œã¦ã„ãã¾ã™ã€‚å˜ä¸€è²¬å‹™ã¨ã„ã†è€ƒãˆæ–¹ãŒæ•´ç†ã•ã‚Œã€ã‚¯ãƒ©ã‚¹å†…ã®ãƒ¡ã‚½ãƒƒãƒ‰ãŒã©ã‚Œã ã‘åŒã˜æ¦‚å¿µã‚’æ‰±ã£ã¦ã„ã‚‹ã‹ãŒé‡è¦è¦–ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚‹ã«ã¤ã‚Œã¦ã€å¤å…¸çš„ãªåˆ†é¡ã¯èƒŒæ™¯ã«å›ã‚Šã€è¨­è¨ˆåŸå‰‡ã®ä¸€éƒ¨ã¨ã—ã¦å¸åã•ã‚Œã¦ã„ãã¾ã—ãŸã€‚

é–¢æ•°å‹è¨€èªã‚„ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰æŠ€è¡“ãŒåºƒãŒã£ãŸ2000å¹´ä»£ä»¥é™ã¯ã€å‡é›†åº¦ã‚’ã€Œã²ã¨ã¾ã¨ã¾ã‚Šã®æ¦‚å¿µçš„å¢ƒç•Œã‚’ã©ã†ä¿ã¤ã‹ã€ã¨ã„ã†ã‚ˆã‚ŠæŠ½è±¡çš„ãªè¦–ç‚¹ã§æ‰ãˆã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚Reactã®ã‚ˆã†ã«UIã‚’å°ã•ãªéƒ¨å“ã¨ã—ã¦çµ„ã¿ä¸Šã’ã‚‹æ çµ„ã¿ã§ã¯ã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚„ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ãŒã²ã¨ã¤ã®ã¯ã£ãã‚Šã—ãŸå½¹å‰²ã‚’æŒã£ã¦ã„ã‚‹ã‹ã©ã†ã‹ãŒã€ãã®ã¾ã¾å‡é›†åº¦ã®è‰¯ã—æ‚ªã—ã«ãªã‚Šã¾ã™ã€‚å¤ã„åˆ†é¡ã‚’ç›´æ¥å½“ã¦ã¯ã‚ã‚‹ã¨ã„ã†ã‚ˆã‚Šã€åˆæœŸã®ç™ºæƒ³ã‚’å—ã‘ç¶™ã„ã ã€Œå¢ƒç•Œã®ä¸­ã«è‡ªç„¶ãªã¾ã¨ã¾ã‚Šã‚’ã¤ãã‚‹ã€ã¨ã„ã†æ€æƒ³ãŒå½¢ã‚’å¤‰ãˆã¦ç”Ÿãã¦ã„ã‚‹ã®ã§ã™ã€‚

## å‡é›†åº¦ã®æ®µéš

å‡é›†åº¦ã«ã¯æ­£å¼ãªåˆ†é¡åãŒã‚ã‚Šã¾ã™ãŒã€ã€Œå¶ç™ºçš„å‡é›†ã€ã€Œæ™‚é–“çš„å‡é›†ã€ã€Œæ‰‹ç¶šãçš„å‡é›†ã€ã€Œæ©Ÿèƒ½çš„å‡é›†ã€ã¨ã„ã£ãŸç”¨èªã¯ã€1970å¹´ä»£ã®æ–‡è„ˆã§åä»˜ã‘ã‚‰ã‚ŒãŸã‚‚ã®ã§ã™ã€‚ç¾ä»£ã®ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™ºã§ã“ã‚Œã‚‰ã®è¨€è‘‰ã‚’èã„ã¦ã‚‚ã€ä½•ã‚’æŒ‡ã—ã¦ã„ã‚‹ã®ã‹ãƒ”ãƒ³ã¨ã“ãªã„ã®ã¯å½“ç„¶ã§ã™ã€‚

ã“ã®è¨˜äº‹ã§ã¯ã€ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ãŸã¨ãã®ã€Œã‚ã‚‹ã‚ã‚‹æ„Ÿã€ã«ç›´çµã™ã‚‹å‘¼ã³æ–¹ã‚’ä½¿ã„ã¾ã™ã€‚å‡é›†åº¦ãŒä½ã„é †ã«ä¸¦ã¹ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

**ã“ã“ã«ç½®ã„ã¨ãã‹å‹ï¼ˆå¶ç™ºçš„å‡é›†ï¼‰**: ãŸã¾ãŸã¾åŒã˜ãƒ•ã‚¡ã‚¤ãƒ«ã«ã„ã‚‹ã ã‘ã®çŠ¶æ…‹ã§ã™ã€‚ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç·¨é›†ãƒšãƒ¼ã‚¸ã«æ—¥ä»˜ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆé–¢æ•°ãŒç½®ã‹ã‚Œã¦ã„ã‚‹ã‚ˆã†ãªå ´åˆãŒã“ã‚Œã«ã‚ãŸã‚Šã¾ã™ã€‚

**ä¼¼ã¦ã‚‹ã‹ã‚‰å‹ï¼ˆè«–ç†çš„å‡é›†ï¼‰**: ã€ŒåŒã˜ã‚«ãƒ†ã‚´ãƒªã ã‹ã‚‰ã€ã€Œè¦‹ãŸç›®ãŒä¼¼ã¦ã„ã‚‹ã‹ã‚‰ã€ã¨ã„ã†ç†ç”±ã§ã¾ã¨ã‚ã¦ã—ã¾ã†çŠ¶æ…‹ã§ã™ã€‚è³¼å…¥è€…ãƒ»å‡ºå“è€…ãƒ»ç®¡ç†è€…å‘ã‘ã®å•†å“è©³ç´°ã‚’1ã¤ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«è©°ã‚è¾¼ã‚€ã‚ˆã†ãªå ´åˆãŒã“ã‚Œã«ã‚ãŸã‚Šã¾ã™ã€‚ã“ã®å•é¡Œã¯[å‰å›ã®è¨˜äº‹](https://zenn.dev/coji/articles/react-router-v7-functional-cohesion-colocation)ã§è©³ã—ãæ‰±ã£ã¦ã„ã¾ã™ã€‚

**åŒæ™‚ã«ã‚„ã‚‹ã‹ã‚‰å‹ï¼ˆæ™‚é–“çš„å‡é›†ï¼‰**: åŒã˜ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§å®Ÿè¡Œã•ã‚Œã‚‹ã‹ã‚‰ä¸€ç·’ã«ã„ã‚‹çŠ¶æ…‹ã§ã™ã€‚ãƒšãƒ¼ã‚¸è¡¨ç¤ºæ™‚ã«ãƒ‡ãƒ¼ã‚¿å–å¾—ã¨ã‚¢ãƒŠãƒªãƒ†ã‚£ã‚¯ã‚¹é€ä¿¡ã‚’ä¸¡æ–¹ã‚„ã‚‹ã‚ˆã†ãªå ´åˆã§ã™ã€‚

**ä¸€é€£ã®æµã‚Œã ã‹ã‚‰å‹ï¼ˆæ‰‹ç¶šãçš„å‡é›†ï¼‰**: å‡¦ç†ã®æµã‚Œã§é€£é–ã—ã¦ã„ã‚‹ã‘ã©ç›®çš„ã¯ãƒãƒ©ãƒãƒ©ãªçŠ¶æ…‹ã§ã™ã€‚ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³â†’ä¿å­˜â†’ç›£æŸ»ãƒ­ã‚°â†’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢ã‚’å…¨éƒ¨ action ã«è©°ã‚è¾¼ã‚€ã‚ˆã†ãªå ´åˆã§ã™ã€‚

**ã“ã‚Œã ã‘ã‚„ã‚‹å‹ï¼ˆæ©Ÿèƒ½çš„å‡é›†ï¼‰**: ã²ã¨ã¤ã®å½¹å‰²ã«é›†ä¸­ã—ã¦ã„ã‚‹çŠ¶æ…‹ã§ã™ã€‚ã“ã‚ŒãŒç›®æŒ‡ã™ã¹ãã‚´ãƒ¼ãƒ«ã«ãªã‚Šã¾ã™ã€‚

ã§ã¯ã€å®Ÿéš›ã®ã‚³ãƒ¼ãƒ‰ã‚’æ”¹å–„ã—ãªãŒã‚‰ã€ã“ã®éšæ®µã‚’ä¸Šã£ã¦ã„ãã¾ã—ã‚‡ã†ã€‚

## å‡ºç™ºç‚¹ï¼šã‚ã‚ŠãŒã¡ãªãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç·¨é›†ãƒšãƒ¼ã‚¸

ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç·¨é›†æ©Ÿèƒ½ã‚’æ€¥ã„ã§ä½œã‚‹ã¨ã€ã“ã‚“ãªæ„Ÿã˜ã®ã‚³ãƒ¼ãƒ‰ã«ãªã‚ŠãŒã¡ã§ã™ã€‚

```tsx
// routes/profile.tsx
import { Form, redirect } from "react-router";
import type { Route } from "./+types/profile";

// ãªãœã‹ã“ã“ã«ã„ã‚‹ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
export const formatDate = (d: Date) => d.toLocaleDateString("ja-JP");
export const slugify = (s: string) => s.toLowerCase().replace(/\s+/g, "-");

export async function loader() {
  const profile = await fetch("/api/profile").then(r => r.json());
  await fetch("/api/analytics", {
    method: "POST",
    body: JSON.stringify({ event: "profile_view" }),
  });
  return { profile };
}

export async function action({ request }: Route.ActionArgs) {
  const form = await request.formData();
  const name = form.get("name") as string;
  const email = form.get("email") as string;

  if (!name.trim()) return { error: "åå‰ã¯å¿…é ˆã§ã™" };
  if (!email.includes("@")) return { error: "ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒä¸æ­£ã§ã™" };

  await fetch("/api/profile", {
    method: "PUT",
    body: JSON.stringify({ name, email }),
  });
  await fetch("/api/audit", {
    method: "POST",
    body: JSON.stringify({ action: "profile_update" }),
  });
  await fetch("/api/cache/clear", { method: "POST" });

  return redirect("/");
}

export default function ProfilePage({
  loaderData,
  actionData,
}: Route.ComponentProps) {
  return (
    <div>
      <h1>ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç·¨é›†</h1>
      <Form method="post">
        <input name="name" defaultValue={loaderData.profile.name} />
        <input name="email" defaultValue={loaderData.profile.email} />
        {actionData?.error && <p style={{ color: "red" }}>{actionData.error}</p>}
        <button type="submit">ä¿å­˜</button>
      </Form>
    </div>
  );
}
```

ã“ã®ã‚³ãƒ¼ãƒ‰ã«ã¯3ã¤ã®å•é¡ŒãŒæ··åœ¨ã—ã¦ã„ã¾ã™ã€‚ã²ã¨ã¤ãšã¤è§£æ¶ˆã—ã¦ã„ãã¾ã—ã‚‡ã†ã€‚

## ã‚¹ãƒ†ãƒƒãƒ—1ï¼šã€Œã“ã“ã«ç½®ã„ã¨ãã‹ã€ã‚’è§£æ¶ˆã™ã‚‹

`formatDate` ã¨ `slugify` ã¯ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç·¨é›†ã¨ä½•ã®é–¢ä¿‚ã‚‚ã‚ã‚Šã¾ã›ã‚“ã€‚ãŸã¾ãŸã¾ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã„ã¦ã„ãŸã‹ã‚‰ç½®ã‹ã‚ŒãŸã ã‘ã§ã™ã€‚

```tsx
// utils/format.ts ã«ç§»å‹•
export const formatDate = (d: Date) => d.toLocaleDateString("ja-JP");
export const slugify = (s: string) => s.toLowerCase().replace(/\s+/g, "-");
```

ãƒ«ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã“ã‚Œã‚‰ã‚’å‰Šé™¤ã™ã‚‹ã ã‘ã§ã€ã€Œã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ä½•ï¼Ÿã€ã¨ã„ã†å•ã„ã«ç­”ãˆã‚„ã™ããªã‚Šã¾ã™ã€‚

## ã‚¹ãƒ†ãƒƒãƒ—2ï¼šã€ŒåŒæ™‚ã«ã‚„ã‚‹ã‹ã‚‰ã€ã‚’è§£æ¶ˆã™ã‚‹

loader ã®ä¸­ã§ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«å–å¾—ã¨ã‚¢ãƒŠãƒªãƒ†ã‚£ã‚¯ã‚¹é€ä¿¡ãŒåŒå±…ã—ã¦ã„ã¾ã™ã€‚ã€Œãƒšãƒ¼ã‚¸è¡¨ç¤ºæ™‚ã«ã‚„ã‚‹ã‹ã‚‰ã€ã¨ã„ã†ç†ç”±ã§ä¸€ç·’ã«ã„ã¾ã™ãŒã€ç›®çš„ãŒé•ã„ã¾ã™ã€‚

```tsx
export async function loader() {
  const profile = await fetch("/api/profile").then(r => r.json());
  return { profile };
}
```

ã‚¢ãƒŠãƒªãƒ†ã‚£ã‚¯ã‚¹ã¯ã“ã®ãƒ«ãƒ¼ãƒˆå›ºæœ‰ã®é–¢å¿ƒäº‹ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ã©ã®ãƒšãƒ¼ã‚¸ã§ã‚‚åŒã˜ã‚ˆã†ã«é€ä¿¡ã—ãŸã„ã¯ãšãªã®ã§ã€è¦ªãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚„ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã§ä¸€å…ƒç®¡ç†ã™ã‚‹ã»ã†ãŒé©åˆ‡ã§ã™ã€‚

## ã‚¹ãƒ†ãƒƒãƒ—3ï¼šã€Œä¸€é€£ã®æµã‚Œã ã‹ã‚‰ã€ã‚’è§£æ¶ˆã™ã‚‹

action ã®ä¸­ã§ã€ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³â†’ä¿å­˜â†’ç›£æŸ»ãƒ­ã‚°â†’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢â†’ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã¨ã€ç›®çš„ã®é•ã†å‡¦ç†ãŒé€£é–ã—ã¦ã„ã¾ã™ã€‚

ã¾ãšã€ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’åˆ†é›¢ã—ã¾ã™ã€‚

```tsx
// features/profile/validation.ts
export function validateProfile(name: string, email: string) {
  if (!name.trim()) return { error: "åå‰ã¯å¿…é ˆã§ã™" };
  if (!email.includes("@")) return { error: "ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒä¸æ­£ã§ã™" };
  return null;
}
```

æ¬¡ã«ã€ç›£æŸ»ãƒ­ã‚°ã¨ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢ã‚’ action ã‹ã‚‰å¤–ã—ã¾ã™ã€‚ã“ã‚Œã‚‰ã¯ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ä¿å­˜ã®ã€Œçµæœã¨ã—ã¦èµ·ãã‚‹ã¹ãã“ã¨ã€ã§ã‚ã‚Šã€APIã‚µãƒ¼ãƒãƒ¼å´ã®è²¬å‹™ã§ã™ã€‚

```tsx
export async function action({ request }: Route.ActionArgs) {
  const form = await request.formData();
  const name = form.get("name") as string;
  const email = form.get("email") as string;

  const validationError = validateProfile(name, email);
  if (validationError) return validationError;

  const res = await fetch("/api/profile", {
    method: "PUT",
    body: JSON.stringify({ name, email }),
  });
  if (!res.ok) return { error: "ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ" };

  return redirect("/");
}
```

## æœ€çµ‚å½¢ï¼šã€Œã“ã‚Œã ã‘ã‚„ã‚‹ã€çŠ¶æ…‹

```tsx
// routes/profile.tsx
import { Form, redirect } from "react-router";
import type { Route } from "./+types/profile";
import { validateProfile } from "../features/profile/validation";

export async function loader() {
  const profile = await fetch("/api/profile").then(r => r.json());
  return { profile };
}

export async function action({ request }: Route.ActionArgs) {
  const form = await request.formData();
  const name = form.get("name") as string;
  const email = form.get("email") as string;

  const error = validateProfile(name, email);
  if (error) return error;

  const res = await fetch("/api/profile", {
    method: "PUT",
    body: JSON.stringify({ name, email }),
  });
  if (!res.ok) return { error: "ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ" };

  return redirect("/");
}

export default function ProfilePage({
  loaderData,
  actionData,
}: Route.ComponentProps) {
  return (
    <div>
      <h1>ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç·¨é›†</h1>
      <Form method="post">
        <input name="name" defaultValue={loaderData.profile.name} />
        <input name="email" defaultValue={loaderData.profile.email} />
        {actionData?.error && <p style={{ color: "red" }}>{actionData.error}</p>}
        <button type="submit">ä¿å­˜</button>
      </Form>
    </div>
  );
}
```

ã€Œã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ä½•ã‚’ã™ã‚‹ã‚‚ã®ã§ã™ã‹ã€ã¨èã‹ã‚ŒãŸã‚‰ã€ã€Œãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’å–å¾—ã—ã¦ã€ç·¨é›†ã—ã¦ã€ä¿å­˜ã™ã‚‹ãƒšãƒ¼ã‚¸ã§ã™ã€ã¨å³ç­”ã§ãã¾ã™ã€‚loader ã¯ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«å–å¾—ã ã‘ã€action ã¯ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã¨ä¿å­˜ã ã‘ã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯ãƒ•ã‚©ãƒ¼ãƒ è¡¨ç¤ºã ã‘ã€‚ã™ã¹ã¦ãŒã²ã¨ã¤ã®ç›®çš„ã‚’æ”¯ãˆã¦ã„ã¾ã™ã€‚

## ã¾ã¨ã‚

å‰å›ã®è¨˜äº‹ã§ã¯ã€ç•°ãªã‚‹æ©Ÿèƒ½ã‚’ãƒ«ãƒ¼ãƒˆå˜ä½ã§åˆ†ã‘ã‚‹ã“ã¨ã®å¤§åˆ‡ã•ã‚’è¦‹ã¾ã—ãŸã€‚ä»Šå›ã¯ã€åˆ†ã‘ãŸãƒ«ãƒ¼ãƒˆã®ä¸­èº«ã‚’ã•ã‚‰ã«æ•´ç†ã™ã‚‹ã“ã¨ã§ã€å‡é›†åº¦ã‚’é«˜ã‚ã‚‹æ–¹æ³•ã‚’è¦‹ã¦ãã¾ã—ãŸã€‚

1970å¹´ä»£ã«ç”Ÿã¾ã‚ŒãŸå‡é›†åº¦ã¨ã„ã†è€ƒãˆæ–¹ã¯ã€æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ãŒå¤‰ã‚ã£ã¦ã‚‚æœ¬è³ªã¯åŒã˜ã§ã™ã€‚ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«ä¸€è²«ã—ãŸè²¬å‹™ã‚’æŒãŸã›ã€ä¸è¦ãªä¾å­˜ã‚’å¤–ã«è¿½ã„å‡ºã™ã¨ã„ã†å®Ÿè·µãŒã€å½“æ™‚ã¨åŒã˜ç›®çš„â”€â”€å¤‰æ›´ã—ã‚„ã™ãå£Šã‚Œã«ãã„æ§‹é€ â”€â”€ã«å‘ã‹ã£ã¦ã„ã¾ã™ã€‚

ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ã„ã¦ã€Œã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ä½•ã‚’ã™ã‚‹ã‚‚ã®ã‹ã€ã«ç­”ãˆã¥ã‚‰ã„ã¨æ„Ÿã˜ãŸã‚‰ã€ä»Šå›è§£æ¶ˆã—ãŸ3ã¤ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆå¶ç™ºçš„ãƒ»æ™‚é–“çš„ãƒ»æ‰‹ç¶šãçš„å‡é›†ï¼‰ã®ã©ã‚Œã‹ã«é™¥ã£ã¦ã„ãªã„ã‹ã€æŒ¯ã‚Šè¿”ã£ã¦ã¿ã¦ãã ã•ã„ã€‚

## å‚è€ƒ

- [æ©Ÿèƒ½çš„å‡é›†ã¨ã‚³ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ä¿å®ˆã—ã‚„ã™ã„ React Router v7 ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¨­è¨ˆ](https://zenn.dev/coji/articles/react-router-v7-functional-cohesion-colocation) - æœ¬è¨˜äº‹ã®å‰ç·¨
- [ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ã®ãã®å‰ã«-å‡é›†åº¦ã¨çµåˆåº¦](https://speakerdeck.com/sonatard/coheision-coupling) - å‡é›†åº¦ã¨çµåˆåº¦ã®åŸºç¤ã‚’è§£èª¬ã—ãŸã‚¹ãƒ©ã‚¤ãƒ‰
- [Structured Design (Stevens, Myers, Constantine, 1974)](https://www.academia.edu/58429322/Structured_design) - å‡é›†åº¦ã®æ¦‚å¿µãŒåˆã‚ã¦ä½“ç³»åŒ–ã•ã‚ŒãŸè«–æ–‡

## ä»˜éŒ²: CLAUDE.md è¿½è¨˜ä¾‹

å‰å›ã®è¨˜äº‹ã®ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã«åŠ ãˆã¦ã€ä»¥ä¸‹ã‚’ CLAUDE.md ã«è¿½è¨˜ã™ã‚‹ã“ã¨ã§ã€AI ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã«ã‚‚ãƒ«ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«å†…ã®å‡é›†åº¦ã‚’æ„è­˜ã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```markdown
### Route File Cohesion

Keep each route file focused on a single purpose.

**Don't mix unrelated utilities:**
- Move generic utilities (formatDate, slugify, debounce) to `utils/` or `lib/`
- Route files should only contain route-specific code

**Don't mix by timing:**
- Loaders should only fetch data needed for this specific route
- Move analytics, logging to parent layouts or middleware
- Each loader/action should have one clear responsibility

**Don't chain unrelated procedures:**
- Extract validation to `features/{feature}/validation.ts`
- Keep audit logs, cache invalidation on the API server side
- Actions should: validate â†’ save â†’ redirect (nothing else)

**Test: "What does this file do?"**
If you can't answer in one sentence, the cohesion is too low.
```
